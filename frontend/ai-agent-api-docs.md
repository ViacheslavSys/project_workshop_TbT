# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–ª—è –ò–ò-–∞–≥–µ–Ω—Ç–∞

**–ü—Ä–æ–µ–∫—Ç:** –ò–ò –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å  
**–í–µ—Ä—Å–∏—è API:** 0.1.0  
**–ë—ç–∫–µ–Ω–¥:** FastAPI (Python)  
**–ê–¥—Ä–µ—Å:** http://localhost:8000

## üîó –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–°–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞:

| –ö–∞–Ω–∞–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| WebSocket `/ws` | –û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª –æ–±—â–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (—á–∞—Ç, —Ä–∏—Å–∫-–æ–ø—Ä–æ—Å, –ø–æ—Ä—Ç—Ñ–µ–ª—å) |
| REST API `/api/...` | –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã: —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è, –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ç.–ø. |

## üß© 1. WebSocket /ws

**–ê–¥—Ä–µ—Å:** `ws://localhost:8000/ws`

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –¥–∞–ª–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON-—Å–æ–æ–±—â–µ–Ω–∏–π.

### üîÑ –û–±—â–∏–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π

#### ‚ñ∂Ô∏è –í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É)

```json
{
  "type": "message_type",
  "content": {}
}
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|-------------|-----------|
| `type` | string | ‚úÖ | –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è (—Å–º. –Ω–∏–∂–µ) |
| `content` | any | ‚öôÔ∏è | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏—è |

#### ‚óÄÔ∏è –ò—Å—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç—É)

```json
{
  "id": "uuid",
  "type": "message_type",
  "content": {},
  "timestamp": 1739539400000,
  "sender": "ai"
}
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|-----------|
| `id` | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è |
| `type` | string | –¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç–∞) |
| `content` | any | –î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞ |
| `timestamp` | number | UNIX-–≤—Ä–µ–º—è (–º—Å) |
| `sender` | string | "ai" ‚Äî —Å–µ—Ä–≤–µ—Ä |

### üí¨ –¢–∏–ø—ã –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (type)

| –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|------------|-----------|
| `message` | –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —á–∞—Ç | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç, —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç —Å —Ç–µ–º –∂–µ —Ç–µ–∫—Å—Ç–æ–º |
| `audio` | –ê—É–¥–∏–æ-—Å–æ–æ–±—â–µ–Ω–∏–µ | content ‚Äî base64 –∞—É–¥–∏–æ; —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –∏ –æ—Ç–≤–µ—Ç |
| `start_risk` | –ù–∞—á–∞–ª–æ —Ä–∏—Å–∫-–æ–ø—Ä–æ—Å–∞ | –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å (type: "risk_questions") |
| `risk_answer` | –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –∞–Ω–∫–µ—Ç—ã | `content = { "questionId": string, "answers": [string] }` |
| `finish` | –ó–∞–ø—Ä–æ—Å —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç portfolio_recommendation |
| `goal_discussion` | –ù–∞—á–∞–ª—å–Ω—ã–π –¥–∏–∞–ª–æ–≥ –æ —Ü–µ–ª—è—Ö | –°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ–º —Å —Ç–µ–∫—Å—Ç–æ–º-—ç—Ö–æ |

### üß† –¢–∏–ø—ã –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (type)

| –¢–∏–ø | –°—Ü–µ–Ω–∞—Ä–∏–π | –ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ |
|-----|----------|-------------------|
| `goal_discussion` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≤–æ–ø—Ä–æ—Å—ã –æ —Ü–µ–ª—è—Ö | "–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–µ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Ü–µ–ª–∏ üëã" |
| `message` | –û—Ç–≤–µ—Ç –±–æ—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–µ | "–û—Ç–≤–µ—Ç –±–æ—Ç–∞: ..." |
| `transcription` | –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∞—É–¥–∏–æ | "–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (—Ç–µ—Å—Ç): —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∞—É–¥–∏–æ." |
| `risk_questions` | –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –∞–Ω–∫–µ—Ç—ã | `{ "questions": [ { id, question, options[] } ], "isFollowUp": false }` |
| `risk_result` | –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | `{ "score": 58, "profile": "–£–º–µ—Ä–µ–Ω–Ω—ã–π" }` |
| `portfolio_recommendation` | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å | –°–º. –ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ |
| `error` | –û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–ª–∏ –ª–æ–≥–∏–∫–∏ | "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è" |

### üìä –ü—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ WebSocket-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

#### 1Ô∏è‚É£ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ

**–°–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç**
```json
{
  "type": "goal_discussion",
  "content": "–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–µ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Ü–µ–ª–∏ üëã"
}
```

#### 2Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç

**–ö–ª–∏–µ–Ω—Ç ‚Üí —Å–µ—Ä–≤–µ—Ä**
```json
{ "type": "goal_discussion", "content": "–•–æ—á—É –Ω–∞–∫–æ–ø–∏—Ç—å –Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—É" }
```

**–°–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç**
```json
{ "type": "message", "content": "–û—Ç–≤–µ—Ç –±–æ—Ç–∞: –•–æ—á—É –Ω–∞–∫–æ–ø–∏—Ç—å –Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—É" }
```

#### 3Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–∏—Å–∫-–∞–Ω–∫–µ—Ç—É

**–ö–ª–∏–µ–Ω—Ç ‚Üí —Å–µ—Ä–≤–µ—Ä**
```json
{ "type": "start_risk" }
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "type": "risk_questions",
  "content": {
    "questions": [
      {
        "id": "q1",
        "question": "–ö–∞–∫ –¥–æ–ª–≥–æ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?",
        "options": [
          { "id": "q1o1", "text": "–ú–µ–Ω–µ–µ 1 –≥–æ–¥–∞", "value": 0 },
          { "id": "q1o2", "text": "1-3 –≥–æ–¥–∞", "value": 1 }
        ]
      }
    ],
    "isFollowUp": false
  }
}
```

#### 4Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç

**–ö–ª–∏–µ–Ω—Ç ‚Üí —Å–µ—Ä–≤–µ—Ä**
```json
{
  "type": "risk_answer",
  "content": { "questionId": "q1", "answers": ["q1o3"] }
}
```

–°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å q2, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–æ q6.

#### 5Ô∏è‚É£ –§–∏–Ω–∞–ª ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∫–µ—Ç—ã:**
```json
{
  "type": "risk_result",
  "content": { "score": 63, "profile": "–£–º–µ—Ä–µ–Ω–Ω—ã–π" }
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è:**
```json
{
  "type": "portfolio_recommendation",
  "content": {
    "name": "–ü–æ—Ä—Ç—Ñ–µ–ª—å –ø–æ–¥ —Ü–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "totalValue": 1000000,
    "expectedReturn": 9.8,
    "riskLevel": "Moderate",
    "assets": [
      { "ticker": "OFZ", "allocation": 45, "expectedReturn": 6.5 },
      { "ticker": "SBER", "allocation": 25, "expectedReturn": 11.0 }
    ],
    "metrics": {
      "sharpeRatio": 1.1,
      "volatility": 9.0,
      "maxDrawdown": 12.0
    }
  }
}
```

## üéß 2. REST API

### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞.

**–û—Ç–≤–µ—Ç:**
```json
{ "status": "ok" }
```

### POST /api/transcribe

–ò–º–∏—Ç–∞—Ü–∏—è –∞—É–¥–∏–æ-—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –§–æ—Ä–º–∞—Ç: `multipart/form-data`
- –ü–æ–ª–µ `file` ‚Äî –±–∏–Ω–∞—Ä–Ω–æ–µ –∞—É–¥–∏–æ (wav/mp3 –∏ —Ç.–¥.)

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -F "file=@voice.wav" http://localhost:8000/api/transcribe
```

**–û—Ç–≤–µ—Ç:**
```json
{ "text": "–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (—Ç–µ—Å—Ç): —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∞—É–¥–∏–æ." }
```

### GET /api/risk-questions

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –∞–Ω–∫–µ—Ç—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ).

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "q1",
    "question": "–ö–∞–∫ –¥–æ–ª–≥–æ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?",
    "options": [
      { "id": "q1o1", "text": "–ú–µ–Ω–µ–µ 1 –≥–æ–¥–∞", "value": 0 }
    ],
    "multiSelect": false
  }
]
```

### GET /api/portfolio/test

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å ¬´—É–º–µ—Ä–µ–Ω–Ω—ã–º¬ª –ø—Ä–æ—Ñ–∏–ª–µ–º.

**–û—Ç–≤–µ—Ç:**
```json
{
  "type": "portfolio_recommendation",
  "portfolio": {
    "name": "–ü–æ—Ä—Ç—Ñ–µ–ª—å –ø–æ–¥ —Ü–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "totalValue": 1000000,
    "expectedReturn": 9.8,
    "riskLevel": "Moderate",
    "assets": [
      { "ticker": "OFZ", "name": "–û–§–ó", "allocation": 45, "expectedReturn": 6.5, "risk": 4.0 },
      { "ticker": "SBER", "name": "–°–±–µ—Ä–±–∞–Ω–∫", "allocation": 25, "expectedReturn": 11.0, "risk": 14.0 },
      { "ticker": "LKOH", "name": "–õ—É–∫–æ–π–ª", "allocation": 20, "expectedReturn": 12.0, "risk": 16.0 },
      { "ticker": "GOLD", "name": "–ó–æ–ª–æ—Ç–æ ETF", "allocation": 10, "expectedReturn": 7.5, "risk": 8.0 }
    ],
    "metrics": {
      "sharpeRatio": 1.1,
      "volatility": 9.0,
      "maxDrawdown": 12.0
    }
  }
}
```

## üîê –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Å—Å–∏–∏

–°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ WebSocket-—Å–µ—Å—Å–∏–∏ –≤ –ø–∞–º—è—Ç–∏ (–≤ —Å–ª–æ–≤–∞—Ä–µ `SESSIONS`).
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è:
- —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø (goals, risk, portfolio)
- –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
- –æ—Ç–≤–µ—Ç—ã –∏ –±–∞–ª–ª—ã
- —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å –∏ –∏—Ç–æ–≥–æ–≤—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å

–ü–æ—Å–ª–µ —Ä–∞–∑—Ä—ã–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏—è –æ—á–∏—â–∞–µ—Ç—Å—è.

## üß† –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã –ò–ò-–∞–≥–µ–Ω—Ç–∞

1. **–ù–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏:** —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`goal_discussion`)
2. **–û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ü–µ–ª–µ–π:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –∏–ª–∏ –∞—É–¥–∏–æ; —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —ç—Ö–æ–º
3. **–ó–∞–ø—É—Å–∫ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è:** –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `start_risk`
4. **–û–ø—Ä–æ—Å:** —Å–µ—Ä–≤–µ—Ä –ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–æ–ø—Ä–æ—Å—ã `risk_questions`, –∫–ª–∏–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç `risk_answer`
5. **–†–∞—Å—á—ë—Ç –ø—Ä–æ—Ñ–∏–ª—è:** –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–µ—Ä –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â–∏–π –±–∞–ª–ª (0‚Äì100%) –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞:
   - 0‚Äì35% ‚Üí –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π
   - 36‚Äì65% ‚Üí –£–º–µ—Ä–µ–Ω–Ω—ã–π  
   - 66‚Äì100% ‚Üí –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π
6. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è:** —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `portfolio_recommendation` —Å –ø—Ä–∏–º–µ—Ä–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤

## üí° –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```javascript
const ws = new WebSocket("ws://localhost:8000/ws");

ws.onmessage = (e) => {
  const msg = JSON.parse(e.data);
  switch (msg.type) {
    case "goal_discussion":
    case "message":
      renderChatMessage(msg.content);
      break;
    case "risk_questions":
      renderRiskQuestion(msg.content.questions[0]);
      break;
    case "risk_result":
      showRiskSummary(msg.content);
      break;
    case "portfolio_recommendation":
      renderPortfolio(msg.content);
      break;
  }
};
```

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ò–ò-–∞–≥–µ–Ω—Ç–∞

| –≠—Ç–∞–ø | –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|------|-------------|---------------|----------|
| –°—Ç–∞—Ä—Ç | - | `goal_discussion` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ |
| –¢–µ–∫—Å—Ç | `message` | `message` | –≠—Ö–æ-–æ—Ç–≤–µ—Ç |
| –ê—É–¥–∏–æ | `audio` | `transcription` + `message` | –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ |
| –û–ø—Ä–æ—Å | `start_risk` | `risk_questions` | –ü–æ–ª—É—á–µ–Ω–∏–µ 1-–≥–æ –≤–æ–ø—Ä–æ—Å–∞ |
| –û—Ç–≤–µ—Ç | `risk_answer` | `risk_questions` / `risk_result` | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ |
| –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ | `finish` | `portfolio_recommendation` | –ò—Ç–æ–≥–æ–≤—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å |

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, REST –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:** JSON
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (—Ç–µ—Å—Ç–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –°–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏, –Ω–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –õ—é–±–æ–π WebSocket-–∫–ª–∏–µ–Ω—Ç (–±—Ä–∞—É–∑–µ—Ä, Node.js, Python –∏ —Ç.–¥.)

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –≤–µ—Ä—Å–∏–∏ API 0.1.0. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∞.*